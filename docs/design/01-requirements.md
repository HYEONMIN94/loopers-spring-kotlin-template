# 유저 시나리오 기반 기능 정의, 요구사항 명세

---

# 유저 (User)

# 회원가입
>### 개요
>- 사용자는 아이디, 성별, 생년월일, 이메일을 입력하여 계정을 생성한다.

>## 기능적 요구사항
>### Happy Path
>- 사용자는 아이디, 성별, 생년월일, 이메일을 입력하고 회원가입을 요청한다.
>- 서버는 입력값 유효성 검사를 통과한 후 계정을 생성하고, 200 OK와 함께 생성된 유저 정보를 응답한다.
>### Fail Cases
>- X-USER-ID 헤더가 존재하지 않을 경우 400 Bad Request가 반환된다.
>- X-USER-ID 헤더의 유저 ID가 존재하지 않을 경우 404 Not Found가 반환된다.
>- 유저 ID:
>    - 중복된 경우 → 409 Conflict
>    - 영문 및 숫자 조합이 아니거나, 10자를 초과하는 경우 → 400 Bad Request
>- 성별:
>    - Male 또는 Female이 아닌 경우 400 Bad Request가 반환된다.
>- 생년월일:
>    - yyyy-MM-dd 형식이 아닌 경우 400 Bad Request가 반환된다.
>- 이메일:
>    - 이메일 형식이 아닌 경우 400 Bad Request가 반환된다.

# 내 정보 조회
>### 개요
>- 사용자는 내 정보(유져 ID, 성별, 이메일, 생년월일)를 조회한다.

>## 기능적 요구사항
>### Happy Path
>- 사용자는 자신의 정보를 조회할 수 있다.
>- 성공 시, 200 OK 응답과 함께 유저 정보(Id, 성별, 생년월일, 이메일 등)를 반환한다.
>### Fail Cases
>- X-USER-ID 헤더가 존재하지 않을 경우 400 Bad Request가 반환된다.
>- X-USER-ID 헤더의 유저 ID가 존재하지 않을 경우 404 Not Found가 반환된다.

---

# 2. 포인트 (Point)

# 충전
>### 개요
>- 사용자는 자신의 포인트를 충전한다.

>## 기능적 요구사항
>### Happy Path
>- 사용자는 충전하고 싶은 포인트만큼 충전할 수 있다.
>- 서버는 입력값 유효성 검사를 통과한 후 포인트를 충전하고, 200 OK와 함께 충전된 포인트 정보를 응답한다.
>### Fail Cases
>- X-USER-ID 헤더가 존재하지 않을 경우 400 Bad Request가 반환된다.
>- X-USER-ID 헤더의 유저 ID가 존재하지 않을 경우 404 Not Found가 반환된다.
>- 충전 양이 0 이하일 경우 400 Bad Request가 반환된다.

# 내 포인트 정보 조회
>### 개요
>- 사용자는 자신의 포인트 정보(유저 ID, 포인트 수량)를 조회한다.

>## 기능적 요구사항
>### Happy Path
>- 사용자는 자신의 포인트 정보를 조회할 수 있다.
>- 성공 시, 200 OK 응답과 함께 포인트 정보(유저 ID, 포인트 수량)를 반환한다.
>### Fail Cases
>- X-USER-ID 헤더가 존재하지 않을 경우 400 Bad Request가 반환된다.
>- X-USER-ID 헤더의 유저 ID가 존재하지 않을 경우 404 Not Found가 반환된다.

---

# 3. 브랜드 (Brand)

# 브랜드 목록 조회
>### 개요
>- 브랜드 목록을 조회한다.

>## 기능 요구사항
>### Happy Path
>- 검색 조건이 적용된 브랜드 목록을 조회한다. 
>- 성공 시, 200 OK와 함께 브랜드 목록을 반환한다.
>- 검색어에 브랜드명을 통해 필터링할 수 있어야 한다.
>- 브랜드명, 등록일을 통해 정렬할 수 있어야 한다.
>### Fail Cases
>- 브랜드 목록이 존재하지 않을 경우 200 OK 와 빈 배열이 반환된다.
>- 브랜드명이 100자가 초과할 경우 400 Bad Request가 반환된다.
>- 브랜드명, 등록일이 아닌 정렬 요청이 들어올 경우 400 Bad Request가 반환된다.

# 브랜드 정보 조회
>### 개요
>- 특정 브랜드 정보를 조회한다.

>## 기능 요구사항
>### Happy Path
>- 성공 시, 200 OK 응답과 함께 브랜드 정보(브랜드명, 브랜드 설명, 해당 브랜드의 상품 목록 등)를 반환한다.
>- 좋아요가 많은 해당 브랜드의 상품목록을 최대 10개의 항목정보가 같이 반환되어야 한다.
>- 해당 브랜드의 상품이 존재하지 않으면 빈 값을 반환한다.
>### Fail Cases
>- 브랜드 정보가 존재하지 않을 경우 404 Not Found가 반환된다.
>- 브랜드명이 100자가 초과할 경우 400 Bad Request가 반환된다.
>- 브랜드명, 등록일이 아닌 정렬 요청이 들어올 경우 400 Bad Request가 반환된다.

---

# 4. 상품 (Product)

# 상품 목록 조회
>### 개요
>- 사용자는 상품 목록을 조회한다.

>## 기능 요구사항
>### Happy Path
>- 검색 조건이 적용된 상품 목록을 조회한다.
>- 성공 시, 200 OK 응답과 함께 상품 목록을 반환한다.
>- 검색어에 상품명을 통해 필터링할 수 있어야 한다.
>- 상품명, 등록일, 좋아요를 통해 정렬할 수 있어야 한다.
>- 한번 조회시에 최대 조회 개수는 20개 까지 가능하여야 한다.
>### Fail Cases
>- 상품 목록이 존재하지 않을 경우 200 OK 와 빈 배열이 반환된다.
>- 유저 정보가 존재하지 않을 경우 좋아요 여부는 빈 값을 반환된다.
>- 상품명으로 인한 조회 시 상품명이 100자가 초과할 경우 400 Bad Request가 반환된다.
>- 브랜드명, 등록일이 아닌 정렬 요청이 들어올 경우 400 Bad Request가 반환된다.

# 상품 정보 조회
>### 개요
>- 사용자는 특정 상품의 정보를 조회한다

>## 기능 요구사항
>### Happy Path
>- 성공 시, 200 OK 응답과 함께 상품 정보(상품명, 상품 설명, 브랜드 정보, 상품 가격, 할인률, 결제 가격, 좋아요 여부)를 반환한다.
>### Fail Cases
>- 상품 정보가 존재하지 않을 경우 404 Not Found가 반환된다.
>- 유저 정보가 존재하지 않을 경우 좋아요 여부는 빈 값을 반환된다.
>- X-USER-ID 헤더가 존재하지 않을 경우 좋아요 여부는 빈 값을 반환된다.
>- X-USER-ID 헤더의 유저 ID가 존재하지 않을 경우 좋아요 여부는 빈 값을 반환된다.
>- 판매중지 상태일 경우 409 Conflict가 반환된다.

---

# 5. 장바구니 (Cart)

# 장바구니 목록 조회

>## 기능적 요구사항
>### Happy Path
>- 사용자는 장바구니에 담긴 목록을 조회할 수 있어야 한다.

>### Fail Cases
>- X-USER-ID 헤더가 존재하지 않을 경우 400 Bad Request가 반환된다.
>- X-USER-ID 헤더의 유저 ID가 존재하지 않을 경우 404 Not Found가 반환된다.
>- 장바구니에 담긴 목록이 존재하지 않을 경우 200 OK 와 빈 배열이 반환된다.

# 장바구니에 상품 담기

>## 기능적 요구사항
>### Happy Path
>- 사용자는 장바구니에 상품을 담을 수 있어야 한다.
>- 이미 장바구니에 담긴 상품을 다시 담을 경우 200 OK와 증가된 수량이 반환된다.

>### Fail Cases
>- X-USER-ID 헤더가 존재하지 않을 경우 400 Bad Request가 반환된다.
>- X-USER-ID 헤더의 유저 ID가 존재하지 않을 경우 404 Not Found가 반환된다.
>- 장바구니에 상품을 담을 때 상품이 존재하지 않을 경우 404 Not Found가 반환된다.

# 장바구니에 담긴 상품 제거

>### Happy Path
>- 사용자는 장바구니에 담긴 상품을 제거할 수 있어야 한다.

>### Fail Cases
>- X-USER-ID 헤더가 존재하지 않을 경우 400 Bad Request가 반환된다.
>- X-USER-ID 헤더의 유저 ID가 존재하지 않을 경우 404 Not Found가 반환된다.
>- 장바구니에 담긴 상품을 제거할 때 담기지 않은 상품을 제거할 경우 400 Bad Request가 반환된다.
>- 장바구니에 담긴 상품을 제거할 때 상품이 존재하지 않을 경우 404 Not Found가 반환된다.

# 6. 좋아요 (Like)

# 상품 좋아요 등록

>## 기능적 요구사항
>### Happy Path
>- 사용자는 특정 상품에 대해 좋아요를 누를 수 있어야 한다.
>- 이미 좋아요를 누른 상품에 다시 요청할 경우 200 OK가 반환된다. 단, 기능은 작동하지 않는다.

>### Fail Cases
>- X-USER-ID 헤더가 존재하지 않을 경우 400 Bad Request가 반환된다.
>- X-USER-ID 헤더의 유저 ID가 존재하지 않을 경우 404 Not Found가 반환된다.
>- 좋아요를 등록하려는 상품이 존재하지 않을 경우 404 Not Found가 반환된다.

# 상품 좋아요 취소

>## 기능적 요구사항
>### Happy Path
>- 사용자는 좋아요를 누른 상품에 대해 좋아요를 취소할 수 있어야 한다.
>- 좋아요를 하지 않은 상품에 대해서 요청할 경우 200 OK가 반환된다. 단, 기능은 작동하지 않는다.

>### Fail Cases
>- X-USER-ID 헤더가 존재하지 않을 경우 400 Bad Request가 반환된다.
>- X-USER-ID 헤더의 유저 ID가 존재하지 않을 경우 404 Not Found가 반환된다.
>- 좋아요를 취소하려는 상품이 존재하지 않을 경우 404 Not Found가 반환된다.

>## 비기능적 요구사항
>- 그 외 오류 발생 시 500 Internal Server Error가 반환된다.

# 좋아요 누른 상품 목록 조회

>### Happy Path
>- 사용자는 본인이 좋아요를 누른 상품 목록을 조회할 수 있어야 한다.

>### Fail Cases
>- X-USER-ID 헤더가 존재하지 않을 경우 400 Bad Request가 반환된다.
>- X-USER-ID 헤더의 유저 ID가 존재하지 않을 경우 404 Not Found가 반환된다.
>- 좋아요를 누른 상품이 없을 경우 200 OK 와 빈 배열이 반환된다.

---

# 7. 주문 (Order)

# 주문 생성

>## 기능적 요구사항
>### Happy Path
>- 사용자는 장바구니에서 선택한 상품들을 기반으로 주문을 생성할 수 있어야 한다.
>- 주문 생성 시 상품 정보, 수량, 결제 예정 금액이 포함되어야 한다.
>- 성공 시 200 OK와 주문 정보가 반환되어야 한다.

>### Fail Cases
>- X-USER-ID 헤더가 존재하지 않을 경우 400 Bad Request가 반환된다.
>- X-USER-ID 헤더의 유저 ID가 존재하지 않을 경우 404 Not Found가 반환된다.
>- 장바구니에서 선택된 상품이 존재하지 않을 경우 400 Bad Request가 반환된다.
>- 상품 재고가 부족할 경우 409 Conflict가 반환된다.
>- 주문 금액 계산 결과와 요청한 금액이 일치하지 않을 경우 400 Bad Request가 반환된다.

# 주문 상세 조회

>## 기능적 요구사항
>### Happy Path
>- 사용자는 본인이 생성한 주문의 상세 정보를 조회할 수 있어야 한다.

>### Fail Cases
>- X-USER-ID 헤더가 존재하지 않을 경우 400 Bad Request가 반환된다.
>- X-USER-ID 헤더의 유저 ID가 존재하지 않을 경우 404 Not Found가 반환된다.
>- 해당 주문이 존재하지 않을 경우 404 Not Found가 반환된다.
>- 사용자 소유가 아닐 경우 404 Not Found가 반환된다.(보안상 이유로 404)

# 주문 목록 조회

>## 기능적 요구사항
>### Happy Path
>- 사용자는 본인의 전체 주문 목록을 조회할 수 있어야 한다.

>### Fail Cases
>- X-USER-ID 헤더가 존재하지 않을 경우 400 Bad Request가 반환된다.
>- X-USER-ID 헤더의 유저 ID가 존재하지 않을 경우 404 Not Found가 반환된다.
>- 주문이 존재하지 않을 경우 200 OK 와 함께 빈 배열이 반환된다.

---

# 8. 결제 (Payment)

# 결제 요청

>## 기능적 요구사항
>### Happy Path
>- 사용자는 주문 생성 후 결제를 요청할 수 있어야 한다.
>- 결제는 포인트 수단으로 진행될 수 있어야 한다. (단, 다른 결제 수단이 생길 수 있다.)

>### Fail Cases
>- X-USER-ID 헤더가 존재하지 않을 경우 400 Bad Request가 반환된다.
>- X-USER-ID 헤더의 유저 ID가 존재하지 않을 경우 404 Not Found가 반환된다.
>- 주문이 존재하지 않을 경우 404 Not Found가 반환된다.
>- 이미 결제된 주문일 경우 409 Conflict가 반환된다.
>- 결제 수단이 유효하지 않을 경우 400 Bad Request가 반환된다.
>- 결제 금액이 실제 주문 금액과 일치하지 않을 경우 400 Bad Request가 반환된다.
>- 재고가 없을 경우 409 Conflict가 반환된다.

# 결제 결과 조회

>## 기능적 요구사항
>### Happy Path
>- 사용자는 특정 주문의 결제 상태를 조회할 수 있어야 한다.

>### Fail Cases
>- X-USER-ID 헤더가 존재하지 않을 경우 400 Bad Request가 반환된다.
>- X-USER-ID 헤더의 유저 ID가 존재하지 않을 경우 404 Not Found가 반환된다.
>- 대상 주문이 존재하지 않을 경우 404 Not Found가 반환된다.
>- 해당 주문이 사용자 소유가 아닐 경우 404 Not Found가 반환된다. (보안상 이유로 404)

---

# 공통 비기능 요구사항 (NFR)
- 회원가입, 로그인, 상품 조회, 브랜드 조회를 제외한 모든 API는 X-USER-ID 인증이 필요하며, 인증되지 않은 사용자는 404 Not Found 응답이 반환된다.
- 페이징이 필요한 API는 page, size 쿼리 파라미터로 통일한다.
- 그 외 오류 발생 시 500 Internal Server Error가 반환된다.
- 시용자만 이용할 수 있는 경우 보안상의 이유로 404 응답을 반환한다.

